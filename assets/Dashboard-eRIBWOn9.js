import{l as b,r as T,j as e}from"./index-B8Dyeey_.js";import{g as z}from"./moduleIntegration-Ds8vBRXc.js";function I(){try{const t=b("animals",[]);if(!Array.isArray(t))return console.warn("Animals data is not an array:",typeof t),{total:0,byType:{},byStatus:{}};const n=t.filter(i=>i.status!=="Sold"&&i.status!=="Deceased"),s={};return n.forEach(i=>{const l=i.type||"Unknown";s[l]=(s[l]||0)+1}),{total:n.length,byType:s,byStatus:R(n)}}catch(t){return console.error("Error calculating animals by type:",t),{total:0,byType:{},byStatus:{}}}}function R(t){const n={};return t.forEach(s=>{const i=s.status||"Active";n[i]=(n[i]||0)+1}),n}function W(){try{const t=b("breeding",[]);if(!Array.isArray(t))return console.warn("Breeding data is not an array:",typeof t),{totalPregnant:0,dueNextMonth:0,overdue:0,successRate:0};const n=new Date,s=t.filter(c=>c.status==="Pregnant"||c.status==="Confirmed"),i=s.filter(c=>{if(!c.dueDate)return!1;const h=(new Date(c.dueDate)-n)/(1e3*60*60*24);return h>=0&&h<=30}),l=s.filter(c=>c.dueDate?new Date(c.dueDate)<n:!1);return{totalPregnant:s.length,dueNextMonth:i.length,overdue:l.length,successRate:B(t)}}catch(t){return console.error("Error calculating breeding stats:",t),{totalPregnant:0,dueNextMonth:0,overdue:0,successRate:0}}}function B(t){const n=t.filter(i=>i.status==="Born"||i.status==="Failed");if(n.length===0)return 0;const s=t.filter(i=>i.status==="Born").length;return Math.round(s/n.length*100)}function $(){try{const t=b("animals",[]),n=b("treatments",[]);if(!Array.isArray(t)||!Array.isArray(n))return console.warn("Health data not arrays:",typeof t,typeof n),{critical:[],upcoming:[],overdue:[]};const s=new Date,i=new Set;n.forEach(d=>{d.endDate&&new Date(d.endDate)>=s&&i.add(d.animalId)});const l=n.filter(d=>d.nextDue?new Date(d.nextDue)<=s:!1),c=t.filter(d=>{if(!d.lastVaccination)return!0;const h=new Date(d.lastVaccination);return(s-h)/(1e3*60*60*24*30)>=6});return{underTreatment:i.size,dueTreatments:l.length,needsVaccination:c.length,totalAlerts:l.length+c.length}}catch(t){return console.error("Error calculating health alerts:",t),{underTreatment:0,dueTreatments:0,needsVaccination:0,totalAlerts:0}}}function L(){try{const t=b("tasks",[]);if(!Array.isArray(t))return console.warn("Tasks data is not an array:",typeof t),{today:[],thisWeek:[],overdue:[]};const n=new Date,s=t.filter(a=>a.status==="Pending"),i=t.filter(a=>a.status==="In Progress"),l=t.filter(a=>a.status==="Completed"),c=t.filter(a=>a.status==="Completed"||!a.dueDate?!1:new Date(a.dueDate).toDateString()===n.toDateString()),d=new Date(n.getTime()+10080*60*1e3),h=t.filter(a=>{if(a.status==="Completed"||!a.dueDate)return!1;const u=new Date(a.dueDate);return u>n&&u<=d}),g=t.filter(a=>a.status==="Completed"||!a.dueDate?!1:new Date(a.dueDate)<n);return{total:t.length,pending:s.length,inProgress:i.length,completed:l.length,dueToday:c.length,dueThisWeek:h.length,overdue:g.length,completionRate:t.length>0?Math.round(l.length/t.length*100):0}}catch(t){return console.error("Error calculating task stats:",t),{total:0,pending:0,inProgress:0,completed:0,dueToday:0,dueThisWeek:0,overdue:0,completionRate:0}}}function Y(t="month"){try{const n=b("transactions",[]);if(!Array.isArray(n))return console.warn("Transactions data is not an array:",typeof n),{income:0,expenses:0,profit:0,transactionCount:0};const s=new Date;let i;switch(t){case"week":i=new Date(s.getTime()-10080*60*1e3);break;case"month":i=new Date(s.getFullYear(),s.getMonth(),1);break;case"year":i=new Date(s.getFullYear(),0,1);break;default:i=new Date(s.getFullYear(),s.getMonth(),1)}const l=n.filter(a=>{const u=new Date(a.date);return u>=i&&u<=s}),c=l.filter(a=>a.type==="Income").reduce((a,u)=>a+(parseFloat(u.amount)||0),0),d=l.filter(a=>a.type==="Expense").reduce((a,u)=>a+(parseFloat(u.amount)||0),0),h=n.filter(a=>a.type==="Income").reduce((a,u)=>a+(parseFloat(u.amount)||0),0),g=n.filter(a=>a.type==="Expense").reduce((a,u)=>a+(parseFloat(u.amount)||0),0);return{period:t,income:c,expenses:d,netProfit:c-d,profitMargin:c>0?Math.round((c-d)/c*100):0,transactionCount:l.length,allTime:{income:h,expenses:g,netProfit:h-g}}}catch(n){return console.error("Error calculating financial summary:",n),{period:t,income:0,expenses:0,netProfit:0,profitMargin:0,transactionCount:0,allTime:{income:0,expenses:0,netProfit:0}}}}function O(t=6){try{const n=b("transactions",[]);if(!Array.isArray(n))return console.warn("Transactions data is not an array:",typeof n),[];const s=new Date,i=n.filter(x=>x.type==="Expense"&&(x.category==="Feed"||x.description&&x.description.toLowerCase().includes("feed"))),l=[];for(let x=t-1;x>=0;x--){const p=new Date(s.getFullYear(),s.getMonth()-x,1),A=new Date(s.getFullYear(),s.getMonth()-x+1,0),o=i.filter(S=>{const j=new Date(S.date);return j>=p&&j<=A}),y=o.reduce((S,j)=>S+(parseFloat(j.amount)||0),0);l.push({month:p.toLocaleDateString("en-US",{month:"short",year:"numeric"}),amount:y,count:o.length})}const c=l.reduce((x,p)=>x+p.amount,0),d=c/t,h=l.slice(0,Math.floor(t/2)),g=l.slice(Math.floor(t/2)),a=h.reduce((x,p)=>x+p.amount,0)/h.length,u=g.reduce((x,p)=>x+p.amount,0)/g.length,v=a>0?Math.round((u-a)/a*100):0;return{monthlyData:l,avgMonthly:d,totalCost:c,trend:v>0?"increasing":v<0?"decreasing":"stable",trendPercent:Math.abs(v)}}catch(n){return console.error("Error calculating feed cost trends:",n),{monthlyData:[],avgMonthly:0,totalCost:0,trend:"stable",trendPercent:0}}}function q(t=10,n=5){try{const s=b("inventory",[]);if(!Array.isArray(s))return console.warn("Inventory data is not an array:",typeof s),{lowStock:[],outOfStock:[],expiringSoon:[]};const i=s.filter(d=>{const h=parseFloat(d.quantity)||0;return h>0&&h<=t&&h>n}),l=s.filter(d=>{const h=parseFloat(d.quantity)||0;return h>0&&h<=n}),c=s.filter(d=>(parseFloat(d.quantity)||0)<=0);return{lowStock:i.length,criticalStock:l.length,outOfStock:c.length,totalAlerts:i.length+l.length+c.length,items:{low:i,critical:l,out:c}}}catch(s){return console.error("Error calculating inventory alerts:",s),{lowStock:0,criticalStock:0,outOfStock:0,totalAlerts:0,items:{low:[],critical:[],out:[]}}}}function H(t="month"){try{const n=b("milkYield",[]);if(!Array.isArray(n))return console.warn("MilkYield data is not an array:",typeof n),{period:t,totalMilk:0,avgDaily:0,producingAnimals:0,recordCount:0};const s=new Date;let i;switch(t){case"week":i=new Date(s.getTime()-10080*60*1e3);break;case"month":i=new Date(s.getFullYear(),s.getMonth(),1);break;case"year":i=new Date(s.getFullYear(),0,1);break;default:i=new Date(s.getFullYear(),s.getMonth(),1)}const l=n.filter(g=>{const a=new Date(g.date);return a>=i&&a<=s}),c=l.reduce((g,a)=>g+(parseFloat(a.amount)||0),0),d=c/Math.max(1,Math.ceil((s-i)/(1e3*60*60*24))),h=new Set(l.map(g=>g.animalId)).size;return{period:t,totalMilk:c,avgDaily:d,producingAnimals:h,recordCount:l.length}}catch(n){return console.error("Error calculating milk production stats:",n),{period:t,totalMilk:0,avgDaily:0,producingAnimals:0,recordCount:0}}}function P(){return{animals:I(),breeding:W(),health:$(),tasks:L(),finance:Y("month"),feedCosts:O(6),inventory:q(),milkProduction:H("month"),lastUpdated:new Date().toISOString()}}function V({onNavigate:t}){const[n,s]=T.useState(null),[i,l]=T.useState(!0),[c,d]=T.useState("month"),[h,g]=T.useState(!0);T.useEffect(()=>{if(a(),h){const r=setInterval(a,6e4);return()=>clearInterval(r)}},[c,h]);const a=()=>{l(!0);try{const r=P(),m=z()||{bySource:{},totalIncome:0,totalExpenses:0,netProfit:0};m.sources=Object.entries(m.bySource||{}).map(([f,w])=>({source:f,...w})),s({...r,integratedFinance:m})}catch(r){console.error("Error loading dashboard:",r),s({...P(),integratedFinance:{bySource:{},totalIncome:0,totalExpenses:0,netProfit:0,sources:[]}})}l(!1)};if(i||!n)return e.jsx("div",{className:"loading",children:"Loading dashboard..."});const{animals:u,breeding:v,health:x,tasks:p,finance:A,feedCosts:o,inventory:y,milkProduction:S,integratedFinance:j}=n,N=j.totalIncome+A.income,M=j.totalExpenses+A.expenses,D=N-M,F=N>0?D/N*100:0;return e.jsxs("div",{className:"dashboard",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{children:"ðŸ“Š Farm Dashboard"}),e.jsxs("div",{className:"dashboard-controls",children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h,onChange:r=>g(r.target.checked)}),"Auto-refresh"]}),e.jsx("button",{onClick:a,className:"btn-secondary",children:"ðŸ”„ Refresh"})]})]}),typeof window<"u"&&window.installPWA&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"16px 20px",borderRadius:8,marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:16,fontWeight:"bold",marginBottom:4},children:"ðŸ“± Install Devins Farm App"}),e.jsx("div",{style:{fontSize:13,opacity:.9},children:"Access the farm management system offline from your home screen"})]}),e.jsx("button",{onClick:async()=>{await window.installPWA?.()&&a()},style:{background:"white",color:"#667eea",border:"none",padding:"10px 20px",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:600,whiteSpace:"nowrap"},children:"Install Now"})]}),typeof window<"u"&&"serviceWorker"in navigator&&e.jsxs("div",{style:{background:navigator.serviceWorker.controller?"#ecfdf5":"#fef3c7",color:navigator.serviceWorker.controller?"#065f46":"#92400e",padding:"8px 12px",borderRadius:6,marginBottom:16,fontSize:13,display:"flex",alignItems:"center",gap:8},children:[navigator.serviceWorker.controller?"âœ…":"âš ï¸",navigator.serviceWorker.controller?"App is ready to work offline":"Offline mode not available - refresh page to activate"]}),(p.overdue>0||x.totalAlerts>0||y.criticalStock>0)&&e.jsxs("div",{className:"alert-bar urgent",children:[e.jsx("strong",{children:"âš ï¸ Attention Required:"}),p.overdue>0&&e.jsxs("span",{children:[" ",p.overdue," overdue task(s)"]}),x.totalAlerts>0&&e.jsxs("span",{children:[" â€¢ ",x.totalAlerts," health alert(s)"]}),y.criticalStock>0&&e.jsxs("span",{children:[" â€¢ ",y.criticalStock," critical inventory item(s)"]})]}),e.jsxs("div",{className:"kpi-grid",children:[e.jsxs("div",{className:"kpi-card",onClick:()=>t&&t("animals"),children:[e.jsx("div",{className:"kpi-icon",children:"ðŸ„"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Total Animals"}),e.jsx("div",{className:"kpi-value",children:u.total}),e.jsx("div",{className:"kpi-details",children:Object.entries(u.byType).map(([r,m])=>e.jsxs("div",{className:"kpi-detail-item",children:[e.jsxs("span",{children:[r,":"]})," ",e.jsx("strong",{children:m})]},r))})]})]}),e.jsxs("div",{className:"kpi-card",onClick:()=>t&&t("tasks"),children:[e.jsx("div",{className:"kpi-icon",children:"âœ…"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Tasks"}),e.jsx("div",{className:"kpi-value",children:p.inProgress+p.pending}),e.jsx("div",{className:"kpi-subtitle",children:"Active"}),e.jsxs("div",{className:"kpi-details",children:[e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Due Today:"})," ",e.jsx("strong",{className:p.dueToday>0?"text-warning":"",children:p.dueToday})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"This Week:"})," ",e.jsx("strong",{children:p.dueThisWeek})]}),p.overdue>0&&e.jsxs("div",{className:"kpi-detail-item text-danger",children:[e.jsx("span",{children:"Overdue:"})," ",e.jsx("strong",{children:p.overdue})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Completion:"})," ",e.jsxs("strong",{children:[p.completionRate,"%"]})]})]})]})]}),e.jsxs("div",{className:"kpi-card",onClick:()=>t&&t("finance"),children:[e.jsx("div",{className:"kpi-icon",children:"ðŸ’°"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Total Finance"}),e.jsxs("div",{className:"kpi-value",style:{color:D>=0?"#10b981":"#ef4444",fontSize:"28px"},children:["KES ",D.toLocaleString("en-KE",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("div",{className:"kpi-subtitle",children:"Net Profit/Loss"}),e.jsxs("div",{className:"kpi-details",children:[e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Total Income:"})," ",e.jsxs("strong",{className:"text-success",children:["KES ",N.toFixed(2)]})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Total Expenses:"})," ",e.jsxs("strong",{className:"text-danger",children:["KES ",M.toFixed(2)]})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Profit Margin:"})," ",e.jsxs("strong",{style:{color:F>=0?"#10b981":"#ef4444"},children:[F.toFixed(1),"%"]})]})]})]})]}),e.jsxs("div",{className:"kpi-card",onClick:()=>t&&t("health"),children:[e.jsx("div",{className:"kpi-icon",children:"ðŸ¥"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Health Status"}),e.jsx("div",{className:"kpi-value",style:{color:x.totalAlerts>0?"#f59e0b":"#10b981"},children:x.totalAlerts}),e.jsx("div",{className:"kpi-subtitle",children:"Alerts"}),e.jsxs("div",{className:"kpi-details",children:[e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Under Treatment:"})," ",e.jsx("strong",{children:x.underTreatment})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Due Treatments:"})," ",e.jsx("strong",{className:x.dueTreatments>0?"text-warning":"",children:x.dueTreatments})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Needs Vaccination:"})," ",e.jsx("strong",{children:x.needsVaccination})]})]})]})]})]}),j&&j.sources&&j.sources.length>0&&e.jsxs("div",{className:"card",style:{padding:"20px",marginTop:"24px"},children:[e.jsx("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",display:"flex",alignItems:"center",gap:"8px"},children:"ðŸ’° Income & Expense Breakdown by Source"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginBottom:"20px"},children:j.sources.map(r=>e.jsxs("div",{style:{padding:"16px",background:r.net>=0?"#f0fdf4":"#fef2f2",borderRadius:"12px",border:`2px solid ${r.net>=0?"#86efac":"#fca5a5"}`,boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontWeight:"700",fontSize:"16px",marginBottom:"12px",color:"#1f2937"},children:r.source}),e.jsxs("div",{style:{display:"grid",gap:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[e.jsx("span",{style:{color:"#6b7280"},children:"Income:"}),e.jsxs("span",{style:{color:"#15803d",fontWeight:"600"},children:["+KES ",r.income.toFixed(2)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px"},children:[e.jsx("span",{style:{color:"#6b7280"},children:"Expenses:"}),e.jsxs("span",{style:{color:"#dc2626",fontWeight:"600"},children:["-KES ",r.expenses.toFixed(2)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"16px",borderTop:"1px solid #e5e7eb",paddingTop:"8px",marginTop:"4px"},children:[e.jsx("span",{style:{fontWeight:"600",color:"#374151"},children:"Net:"}),e.jsxs("span",{style:{fontWeight:"700",fontSize:"18px",color:r.net>=0?"#059669":"#dc2626"},children:[r.net>=0?"+":"","KES ",r.net.toFixed(2)]})]})]})]},r.source))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginTop:"20px",paddingTop:"20px",borderTop:"2px solid #e5e7eb"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"16px",background:"#ecfdf5",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginBottom:"8px"},children:"Total Income"}),e.jsxs("div",{style:{fontSize:"28px",fontWeight:"700",color:"#15803d"},children:["KES ",N.toFixed(2)]})]}),e.jsxs("div",{style:{textAlign:"center",padding:"16px",background:"#fef2f2",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginBottom:"8px"},children:"Total Expenses"}),e.jsxs("div",{style:{fontSize:"28px",fontWeight:"700",color:"#dc2626"},children:["KES ",M.toFixed(2)]})]}),e.jsxs("div",{style:{textAlign:"center",padding:"16px",background:D>=0?"#f0fdf4":"#fef2f2",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginBottom:"8px"},children:"Net Profit/Loss"}),e.jsxs("div",{style:{fontSize:"28px",fontWeight:"700",color:D>=0?"#059669":"#dc2626"},children:[D>=0?"+":"","KES ",D.toFixed(2)]}),e.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:["Margin: ",F.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"kpi-grid",children:[e.jsxs("div",{className:"kpi-card",onClick:()=>t&&t("breeding"),children:[e.jsx("div",{className:"kpi-icon",children:"ðŸ¤°"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Breeding"}),e.jsx("div",{className:"kpi-value",children:v.totalPregnant}),e.jsx("div",{className:"kpi-subtitle",children:"Pregnant"}),e.jsxs("div",{className:"kpi-details",children:[e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Due Next Month:"})," ",e.jsx("strong",{children:v.dueNextMonth})]}),v.overdue>0&&e.jsxs("div",{className:"kpi-detail-item text-danger",children:[e.jsx("span",{children:"Overdue:"})," ",e.jsx("strong",{children:v.overdue})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Success Rate:"})," ",e.jsxs("strong",{children:[v.successRate,"%"]})]})]})]})]}),e.jsxs("div",{className:"kpi-card",onClick:()=>t&&t("inventory"),children:[e.jsx("div",{className:"kpi-icon",children:"ðŸ“¦"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Inventory"}),e.jsx("div",{className:"kpi-value",style:{color:y.totalAlerts>0?"#f59e0b":"#10b981"},children:y.totalAlerts}),e.jsx("div",{className:"kpi-subtitle",children:"Alerts"}),e.jsxs("div",{className:"kpi-details",children:[y.criticalStock>0&&e.jsxs("div",{className:"kpi-detail-item text-danger",children:[e.jsx("span",{children:"Critical:"})," ",e.jsx("strong",{children:y.criticalStock})]}),e.jsxs("div",{className:"kpi-detail-item text-warning",children:[e.jsx("span",{children:"Low Stock:"})," ",e.jsx("strong",{children:y.lowStock})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Out of Stock:"})," ",e.jsx("strong",{children:y.outOfStock})]})]})]})]}),S.totalMilk>0&&e.jsxs("div",{className:"kpi-card",children:[e.jsx("div",{className:"kpi-icon",children:"ðŸ¥›"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Milk Production"}),e.jsx("div",{className:"kpi-value",children:S.totalMilk.toFixed(1)}),e.jsx("div",{className:"kpi-subtitle",children:"Liters (This Month)"}),e.jsxs("div",{className:"kpi-details",children:[e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Avg Daily:"})," ",e.jsxs("strong",{children:[S.avgDaily.toFixed(1)," L"]})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Producing:"})," ",e.jsxs("strong",{children:[S.producingAnimals," animals"]})]})]})]})]}),e.jsxs("div",{className:"kpi-card",children:[e.jsx("div",{className:"kpi-icon",children:"ðŸŒ¾"}),e.jsxs("div",{className:"kpi-content",children:[e.jsx("h3",{children:"Feed Costs"}),e.jsxs("div",{className:"kpi-value",style:{color:o.trend==="increasing"?"#ef4444":o.trend==="decreasing"?"#10b981":"#3b82f6"},children:["$",o.avgMonthly?o.avgMonthly.toFixed(0):"0"]}),e.jsx("div",{className:"kpi-subtitle",children:"Monthly Average"}),e.jsxs("div",{className:"kpi-details",children:[e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Last 6 Months:"})," ",e.jsxs("strong",{children:["$",o.totalCost?o.totalCost.toLocaleString():"0"]})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Trend:"}),e.jsxs("strong",{style:{color:o.trend==="increasing"?"#ef4444":o.trend==="decreasing"?"#10b981":"#6b7280"},children:[o.trend==="increasing"?"ðŸ“ˆ ":o.trend==="decreasing"?"ðŸ“‰ ":"âž¡ï¸ ",o.trend||"stable",o.trendPercent?` (${o.trendPercent}%)`:""]})]}),e.jsxs("div",{className:"kpi-detail-item",children:[e.jsx("span",{children:"Per Animal/Day:"}),e.jsxs("strong",{children:["$",u.total>0&&o.avgMonthly?(o.avgMonthly/30/u.total).toFixed(2):"0.00"]})]})]})]})]})]}),o.monthlyData&&o.monthlyData.length>0&&e.jsxs("div",{className:"chart-container",style:{marginTop:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h3",{children:"ðŸ“ˆ Feed Cost Analysis"}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:[e.jsxs("span",{style:{marginRight:12},children:[e.jsx("strong",{children:"Total Transactions:"})," ",o.monthlyData.reduce((r,m)=>r+(m.count||0),0)]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Avg per Month:"})," $",o.avgMonthly?o.avgMonthly.toFixed(0):"0"]})]})]}),e.jsxs("div",{className:"bar-chart",style:{display:"flex",alignItems:"flex-end",justifyContent:"space-around",height:280,gap:8,padding:"16px 0",borderBottom:"2px solid #333",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:32,width:50,display:"flex",flexDirection:"column",justifyContent:"space-between",fontSize:10,color:"#666",paddingRight:8,textAlign:"right"},children:(()=>{const r=Math.max(...o.monthlyData.map(m=>m.amount||0),1);return[r,r*.75,r*.5,r*.25,0].map((m,f)=>e.jsxs("div",{children:["$",m.toFixed(0)]},f))})()}),e.jsx("div",{style:{display:"flex",flex:1,alignItems:"flex-end",justifyContent:"space-around",gap:8,marginLeft:60},children:o.monthlyData.map((r,m)=>{const f=Math.max(...o.monthlyData.map(k=>k.amount||0),1),w=f>0?(r.amount||0)/f*100:0,C=r.amount===f&&f>0,E=r.amount===Math.min(...o.monthlyData.map(k=>k.amount||0));return e.jsxs("div",{className:"bar-chart-item",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},title:`${r.month}: $${(r.amount||0).toFixed(2)} (${r.count||0} transactions)`,children:[e.jsx("div",{className:"bar-chart-bar",style:{height:`${w}%`,minHeight:w>0?"4px":"0",width:"100%",background:C?"linear-gradient(180deg, #ef4444 0%, #dc2626 100%)":E&&r.amount>0?"linear-gradient(180deg, #10b981 0%, #059669 100%)":"linear-gradient(180deg, #3b82f6 0%, #2563eb 100%)",borderRadius:"4px 4px 0 0",position:"relative",transition:"all 0.3s ease",cursor:"pointer",boxShadow:"0 -2px 4px rgba(0,0,0,0.1)"},onMouseEnter:k=>{k.currentTarget.style.transform="scaleY(1.05)",k.currentTarget.style.opacity="0.8"},onMouseLeave:k=>{k.currentTarget.style.transform="scaleY(1)",k.currentTarget.style.opacity="1"},children:w>15&&e.jsxs("span",{className:"bar-chart-value",style:{position:"absolute",top:-20,left:"50%",transform:"translateX(-50%)",fontSize:10,fontWeight:"bold",color:"#111",whiteSpace:"nowrap",background:"rgba(255,255,255,0.9)",padding:"2px 4px",borderRadius:3,border:"1px solid #ddd"},children:["$",(r.amount||0).toFixed(0)]})}),e.jsx("div",{className:"bar-chart-label",style:{marginTop:8,fontSize:10,color:"#666",textAlign:"center",fontWeight:C||E?"bold":"normal"},children:r.month}),(r.count||0)>0&&e.jsxs("div",{style:{fontSize:9,color:"#999",marginTop:2},children:[r.count," tx"]})]},m)})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12,marginTop:16,padding:12,background:"#f9fafb",borderRadius:8},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#666",marginBottom:4},children:"Highest Month"}),e.jsx("div",{style:{fontSize:14,fontWeight:"bold",color:"#ef4444"},children:(()=>{const r=o.monthlyData.reduce((m,f)=>f.amount>m.amount?f:m,o.monthlyData[0]);return`${r.month}: $${(r.amount||0).toFixed(0)}`})()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#666",marginBottom:4},children:"Lowest Month"}),e.jsx("div",{style:{fontSize:14,fontWeight:"bold",color:"#10b981"},children:(()=>{const r=o.monthlyData.reduce((m,f)=>f.amount<m.amount?f:m,o.monthlyData[0]);return`${r.month}: $${(r.amount||0).toFixed(0)}`})()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#666",marginBottom:4},children:"Cost per Animal (Monthly)"}),e.jsxs("div",{style:{fontSize:14,fontWeight:"bold",color:"#3b82f6"},children:["$",u.total>0&&o.avgMonthly?(o.avgMonthly/u.total).toFixed(2):"0.00"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#666",marginBottom:4},children:"Projected Next Month"}),e.jsxs("div",{style:{fontSize:14,fontWeight:"bold",color:"#6366f1"},children:["$",(()=>{if(o.monthlyData.length<2)return o.avgMonthly?o.avgMonthly.toFixed(0):"0";const r=o.monthlyData.slice(-3);return(r.reduce((f,w)=>f+(w.amount||0),0)/r.length).toFixed(0)})()]})]})]})]}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("h3",{children:"âš¡ Quick Actions"}),e.jsxs("div",{className:"quick-actions-grid",children:[e.jsx("button",{onClick:()=>t&&t("animals"),className:"btn-primary",children:"âž• Add Animal"}),e.jsx("button",{onClick:()=>t&&t("tasks"),className:"btn-primary",children:"ðŸ“ New Task"}),e.jsx("button",{onClick:()=>t&&t("finance"),className:"btn-primary",children:"ðŸ’³ Add Transaction"}),e.jsx("button",{onClick:()=>t&&t("inventory"),className:"btn-primary",children:"ðŸ“¦ Update Inventory"})]})]}),e.jsx("div",{className:"dashboard-footer",children:e.jsxs("small",{children:["Last updated: ",new Date(n.lastUpdated).toLocaleString()]})})]})}export{V as default};
