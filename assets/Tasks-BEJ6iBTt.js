import{r as d,j as t}from"./index-B8Dyeey_.js";import{e as $,a as q,c as K,i as Y,f as G}from"./exportImport-BcQPf7S7.js";const _=[{id:"T-001",title:"Check water troughs",description:"Inspect all water systems in pastures A-D",assignedTo:"John Smith",due:"2025-11-16",priority:"High",category:"Maintenance",done:!1,createdDate:"2025-11-15",estimatedHours:2,notes:[],location:"Pasture A-D"},{id:"T-002",title:"Move herd to pasture B",description:"Rotate cattle from pasture A to pasture B for better grazing",assignedTo:"Mike Johnson",due:"2025-11-17",priority:"Medium",category:"Animal Care",done:!1,createdDate:"2025-11-15",estimatedHours:4,notes:[],location:"Pasture B"},{id:"T-003",title:"Veterinary checkup",description:"Schedule and conduct quarterly health checks",assignedTo:"Dr. Sarah Wilson",due:"2025-11-20",priority:"High",category:"Health",done:!1,createdDate:"2025-11-15",estimatedHours:6,notes:[],location:"Clinic"}],H=["Animal Care","Maintenance","Health","Feed & Nutrition","Breeding","Equipment","Administrative","Other"],E=["Low","Medium","High","Critical"],Q=["Unassigned","John Smith","Mike Johnson","Dr. Sarah Wilson","Emma Davis","Tom Brown"];function ee(){const S="cattalytics:tasks",[n,a]=d.useState([]),[h,A]=d.useState("all"),[b,c]=d.useState(!1),[T,m]=d.useState(null),[p,j]=d.useState(null),[v,M]=d.useState("all"),[C,k]=d.useState("all"),[y,O]=d.useState("due"),[r,o]=d.useState({title:"",description:"",assignedTo:"Unassigned",due:"",priority:"Medium",category:"Animal Care",estimatedHours:1,location:""});d.useEffect(()=>{const e=localStorage.getItem(S);a(e?JSON.parse(e):_)},[]),d.useEffect(()=>localStorage.setItem(S,JSON.stringify(n)),[n]);function B(){if(!r.title.trim())return;const i={id:"T-"+Math.floor(1e3+Math.random()*9e3),...r,title:r.title.trim(),done:!1,createdDate:new Date().toISOString().slice(0,10),notes:[]};a([...n,i]),o({title:"",description:"",assignedTo:"Unassigned",due:"",priority:"Medium",category:"Animal Care",estimatedHours:1,location:""}),c(!1)}function z(e){confirm("Delete task "+e+"?")&&a(n.filter(i=>i.id!==e))}function D(e){a(n.map(i=>i.id===e?{...i,done:!i.done,completedDate:i.done?null:new Date().toISOString().slice(0,10)}:i))}function P(e,i){i.trim()&&a(n.map(l=>l.id===e?{...l,notes:[...l.notes||[],{id:Date.now(),text:i.trim(),date:new Date().toISOString(),author:"Current User"}]}:l))}function w(e){o({title:e.title,description:e.description||"",assignedTo:e.assignedTo||"Unassigned",due:e.due||"",priority:e.priority||"Medium",category:e.category||"Animal Care",estimatedHours:e.estimatedHours||1,location:e.location||""}),j(e.id),c(!0)}function R(){r.title.trim()&&(a(n.map(e=>e.id===p?{...e,...r,title:r.title.trim()}:e)),o({title:"",description:"",assignedTo:"Unassigned",due:"",priority:"Medium",category:"Animal Care",estimatedHours:1,location:""}),j(null),c(!1))}function J(){o({title:"",description:"",assignedTo:"Unassigned",due:"",priority:"Medium",category:"Animal Care",estimatedHours:1,location:""}),j(null),c(!1)}const N=n.filter(e=>!(h==="pending"&&e.done||h==="completed"&&!e.done||h==="overdue"&&(e.done||!e.due||new Date(e.due)>=new Date)||v!=="all"&&e.category!==v||C!=="all"&&e.priority!==C)).sort((e,i)=>{if(y==="due")return new Date(e.due||"9999-12-31")-new Date(i.due||"9999-12-31");if(y==="priority"){const l={Critical:4,High:3,Medium:2,Low:1};return l[i.priority]-l[e.priority]}return y==="created"?new Date(i.createdDate)-new Date(e.createdDate):0}),f={total:n.length,completed:n.filter(e=>e.done).length,pending:n.filter(e=>!e.done).length,overdue:n.filter(e=>!e.done&&e.due&&new Date(e.due)<new Date).length},I=d.useRef(null);function U(){const e=filtered.map(i=>({id:i.id,title:i.title,description:i.description,category:i.category,priority:i.priority,assignedTo:i.assignedTo,due:i.due,status:i.done?"Completed":"Pending",createdDate:i.createdDate,estimatedHours:i.estimatedHours,location:i.location}));$(e,"tasks.csv")}function F(){const e=filtered.map(i=>({id:i.id,title:i.title,description:i.description,category:i.category,priority:i.priority,assignedTo:i.assignedTo,due:i.due,status:i.done?"Completed":"Pending",createdDate:i.createdDate,estimatedHours:i.estimatedHours,location:i.location}));q(e,"tasks_export.csv")}function L(){K(filtered,"tasks.json")}function V(){I.current?.click()}function W(e){const i=e.target.files?.[0];if(!i)return;const l=i.name.split(".").pop()?.toLowerCase();l==="json"?Y(i,(u,x)=>{if(x){alert("Import failed: "+x.message);return}if(confirm(`Import ${u.length} tasks? This will merge with existing data.`)){const g=u.map(s=>({...s,id:s.id||"T-"+Math.floor(1e3+Math.random()*9e3)}));a([...n,...g]),alert(`Imported ${g.length} tasks`)}}):l==="csv"?G(i,(u,x)=>{if(x){alert("Import failed: "+x.message);return}if(confirm(`Import ${u.length} tasks? This will merge with existing data.`)){const g=u.map(s=>({id:s.id||"T-"+Math.floor(1e3+Math.random()*9e3),title:s.title||"",description:s.description||"",category:s.category||"Other",priority:s.priority||"Medium",assignedTo:s.assignedTo||"Unassigned",due:s.due||"",done:s.status==="Completed",createdDate:s.createdDate||new Date().toISOString().slice(0,10),estimatedHours:s.estimatedHours?Number(s.estimatedHours):1,location:s.location||"",notes:[]}));a([...n,...g]),alert(`Imported ${g.length} tasks`)}}):alert("Unsupported file type. Use CSV or JSON."),e.target.value=""}return t.jsxs("section",{children:[t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",flexWrap:"wrap",gap:"8px"},children:[t.jsx("h2",{style:{margin:0},children:"Task Management"}),t.jsxs("div",{style:{display:"flex",gap:4},children:[t.jsx("button",{onClick:U,title:"Export to CSV",style:{fontSize:12},children:"ðŸ“Š CSV"}),t.jsx("button",{onClick:F,title:"Export to Excel",style:{fontSize:12},children:"ðŸ“ˆ Excel"}),t.jsx("button",{onClick:L,title:"Export to JSON",style:{fontSize:12},children:"ðŸ“„ JSON"}),t.jsx("button",{onClick:V,title:"Import from file",style:{fontSize:12},children:"ðŸ“¥ Import"}),t.jsx("input",{ref:I,type:"file",accept:".csv,.json",style:{display:"none"},onChange:W}),t.jsx("button",{onClick:()=>c(!b),className:"add-row button",style:{background:"var(--green)",color:"#fff",padding:"10px 16px",borderRadius:"8px",border:"none"},children:"Add New Task"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[t.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--green)"},children:f.total}),t.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Total Tasks"})]}),t.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#f59e0b"},children:f.pending}),t.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Pending"})]}),t.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--green)"},children:f.completed}),t.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Completed"})]}),t.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#dc2626"},children:f.overdue}),t.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Overdue"})]})]})]}),b&&t.jsxs("div",{className:"card",style:{marginBottom:"20px",padding:"20px"},children:[t.jsx("h3",{children:p?"Edit Task":"Add New Task"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:[t.jsx("input",{placeholder:"Task title",value:r.title,onChange:e=>o({...r,title:e.target.value})}),t.jsx("select",{value:r.category,onChange:e=>o({...r,category:e.target.value}),children:H.map(e=>t.jsx("option",{value:e,children:e},e))}),t.jsx("textarea",{placeholder:"Description",value:r.description,onChange:e=>o({...r,description:e.target.value}),style:{gridColumn:"1 / -1",minHeight:"80px"}}),t.jsx("select",{value:r.assignedTo,onChange:e=>o({...r,assignedTo:e.target.value}),children:Q.map(e=>t.jsx("option",{value:e,children:e},e))}),t.jsx("select",{value:r.priority,onChange:e=>o({...r,priority:e.target.value}),children:E.map(e=>t.jsx("option",{value:e,children:e},e))}),t.jsx("input",{type:"date",value:r.due,onChange:e=>o({...r,due:e.target.value})}),t.jsx("input",{type:"number",placeholder:"Est. Hours",value:r.estimatedHours,onChange:e=>o({...r,estimatedHours:Number(e.target.value)})}),t.jsx("input",{placeholder:"Location",value:r.location,onChange:e=>o({...r,location:e.target.value}),style:{gridColumn:"1 / -1"}})]}),t.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:p?R:B,style:{background:"var(--green)",color:"#fff",padding:"10px 16px",border:"none",borderRadius:"6px"},children:p?"Save Changes":"Add Task"}),t.jsx("button",{onClick:p?J:()=>c(!1),style:{background:"#6b7280",color:"#fff",padding:"10px 16px",border:"none",borderRadius:"6px"},children:"Cancel"})]})]}),t.jsx("div",{className:"card",style:{marginBottom:"20px",padding:"16px"},children:t.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center",flexWrap:"wrap"},children:[t.jsx("div",{style:{display:"flex",gap:"8px"},children:["all","pending","completed","overdue"].map(e=>t.jsx("button",{onClick:()=>A(e),className:`tab-btn ${h===e?"active":""}`,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),t.jsxs("select",{value:v,onChange:e=>M(e.target.value),style:{padding:"6px 8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:[t.jsx("option",{value:"all",children:"All Categories"}),H.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{value:C,onChange:e=>k(e.target.value),style:{padding:"6px 8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:[t.jsx("option",{value:"all",children:"All Priorities"}),E.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{value:y,onChange:e=>O(e.target.value),style:{padding:"6px 8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:[t.jsx("option",{value:"due",children:"Sort by Due Date"}),t.jsx("option",{value:"priority",children:"Sort by Priority"}),t.jsx("option",{value:"created",children:"Sort by Created"})]})]})}),t.jsx("div",{style:{display:"grid",gap:"12px"},children:N.map(e=>t.jsx("div",{className:"card",style:{padding:"16px",border:e.done?"1px solid #d1fae5":"1px solid #e5e7eb"},children:t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[t.jsx("input",{type:"checkbox",checked:e.done,onChange:()=>D(e.id),style:{marginTop:"4px"}}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("h4",{style:{margin:0,textDecoration:e.done?"line-through":"none"},children:e.title}),t.jsx("span",{className:`badge ${e.priority==="Critical"||e.priority==="High"?"flag":"badge"}`,children:e.priority}),t.jsx("span",{className:"badge",children:e.category})]}),t.jsx("p",{style:{margin:"4px 0",color:"var(--muted)",fontSize:"14px"},children:e.description}),t.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"12px",color:"var(--muted)"},children:[t.jsxs("span",{children:["ðŸ‘¤ ",e.assignedTo]}),t.jsxs("span",{children:["ðŸ“… ",e.due?`Due ${e.due}`:"No due date"]}),t.jsxs("span",{children:["â±ï¸ ",e.estimatedHours,"h"]}),e.location&&t.jsxs("span",{children:["ðŸ“ ",e.location]})]})]}),t.jsxs("div",{className:"controls",children:[t.jsx("button",{onClick:()=>m(e.id),children:"View"}),t.jsx("button",{onClick:()=>w(e),children:"Edit"}),t.jsx("button",{onClick:()=>z(e.id),children:"Delete"})]})]})},e.id))}),N.length===0&&t.jsxs("div",{className:"card",style:{padding:"40px",textAlign:"center",color:"var(--muted)"},children:[t.jsx("h3",{children:"No tasks found"}),t.jsx("p",{children:"No tasks match your current filters. Try adjusting your search criteria."})]}),T&&(()=>{const e=n.find(i=>i.id===T);return e?t.jsx("div",{className:"drawer-overlay",onClick:()=>m(null),children:t.jsxs("div",{className:"drawer",onClick:i=>i.stopPropagation(),children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[t.jsx("h3",{children:e.title}),t.jsxs("div",{children:[t.jsx("button",{onClick:()=>D(e.id),children:e.done?"Mark Incomplete":"Mark Complete"}),t.jsx("button",{onClick:()=>{m(null),w(e)},style:{marginLeft:"8px"},children:"Edit"}),t.jsx("button",{onClick:()=>m(null),style:{marginLeft:"8px"},children:"Close"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 300px",gap:"20px"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("h4",{children:"Description"}),t.jsx("p",{children:e.description||"No description provided"})]}),t.jsxs("div",{children:[t.jsx("h4",{children:"Notes & Updates"}),t.jsx("div",{style:{marginBottom:"12px"},children:t.jsx("input",{placeholder:"Add a note...",onKeyPress:i=>{i.key==="Enter"&&i.target.value.trim()&&(P(e.id,i.target.value),i.target.value="")},style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})}),t.jsxs("div",{style:{maxHeight:"300px",overflowY:"auto"},children:[(e.notes||[]).slice().reverse().map(i=>t.jsxs("div",{style:{padding:"8px",background:"#f9fafb",borderRadius:"4px",marginBottom:"8px"},children:[t.jsxs("div",{style:{fontSize:"12px",color:"var(--muted)",marginBottom:"4px"},children:[i.author," â€¢ ",new Date(i.date).toLocaleString()]}),t.jsx("div",{children:i.text})]},i.id)),(!e.notes||e.notes.length===0)&&t.jsx("div",{style:{color:"var(--muted)",fontStyle:"italic"},children:"No notes yet"})]})]})]}),t.jsxs("div",{className:"card",style:{padding:"16px",height:"fit-content"},children:[t.jsx("h4",{children:"Task Details"}),t.jsxs("div",{style:{display:"grid",gap:"12px",fontSize:"14px"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Status:"})," ",t.jsx("span",{className:e.done?"badge green":"badge",children:e.done?"Completed":"Pending"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Priority:"})," ",t.jsx("span",{className:`badge ${e.priority==="Critical"||e.priority==="High"?"flag":""}`,children:e.priority})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Category:"})," ",e.category]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Assigned to:"})," ",e.assignedTo]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Due Date:"})," ",e.due||"Not set"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Est. Hours:"})," ",e.estimatedHours]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Location:"})," ",e.location||"Not specified"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Created:"})," ",e.createdDate]}),e.completedDate&&t.jsxs("div",{children:[t.jsx("strong",{children:"Completed:"})," ",e.completedDate]})]})]})]})]})}):null})()]})}export{ee as default};
