import{r,j as e}from"./index-B8Dyeey_.js";import{r as $}from"./moduleIntegration-Ds8vBRXc.js";import{a as _,c as Q,e as J,d as V}from"./exportImport-BcQPf7S7.js";const re=[{id:"CY-001",cropId:"C-001",date:"2025-09-01",quantity:120,pricePerUnit:0,totalPrice:0,buyer:"",sold:!1}];function ae({crops:c,cropId:a}){const m="cattalytics:crop:yield",[s,u]=r.useState([]),[v,T]=r.useState(a||(c&&c[0]?c[0].id:"")),[h,S]=r.useState(""),[g,E]=r.useState("80"),[C,d]=r.useState(""),[p,k]=r.useState(!1),[y,P]=r.useState(null);r.useEffect(()=>{const n=localStorage.getItem(m);u(n?JSON.parse(n):re)},[]),r.useEffect(()=>localStorage.setItem(m,JSON.stringify(s)),[s]);function W(){if(!v||!h)return;const n=Number(h),o=parseFloat(g)||0,j=n*o,M=c?.find(F=>F.id===v)?.name||v;if(y){u(s.map(F=>F.id===y?{...F,cropId:v,quantity:n,pricePerUnit:o,totalPrice:j,buyer:C.trim(),sold:p}:F)),P(null),S(""),E("80"),d(""),k(!1);return}const L="CY-"+Math.floor(1e3+Math.random()*9e3),O={id:L,cropId:v,date:new Date().toISOString().slice(0,10),quantity:n,pricePerUnit:o,totalPrice:j,buyer:C.trim(),sold:p};p&&j>0&&$({amount:j,category:"Crop Sales",subcategory:C?"Direct Sales":"Market Sales",description:`${M}: ${n} units @ ${o}/unit`,vendor:C||"Market Buyer",source:"Crop Yield",linkedId:L}),u([...s,O]),S(""),E("80"),d(""),k(!1)}function l(n){confirm("Delete record "+n+"?")&&u(s.filter(o=>o.id!==n))}function x(n){P(n.id),T(n.cropId),S(String(n.quantity)),E(String(n.pricePerUnit)),d(n.buyer||""),k(n.sold||!1)}function N(){P(null),S(""),E("80"),d(""),k(!1),!a&&c&&c[0]&&T(c[0].id)}const B=a?s.filter(n=>n.cropId===a):s,A=B.filter(n=>n.sold).reduce((n,o)=>n+(o.totalPrice||0),0),I=B.filter(n=>n.sold).reduce((n,o)=>n+(o.quantity||0),0),D=B.reduce((n,o)=>n+(o.quantity||0),0),R=()=>{const n=B.map(o=>({ID:o.id,Date:o.date,Crop:c?.find(j=>j.id===o.cropId)?.name||o.cropId,Quantity:o.quantity,PricePerUnit:o.pricePerUnit,TotalPrice:o.totalPrice,Sold:o.sold?"Yes":"No",Buyer:o.buyer||"N/A"}));J(n,"crop_yield.csv")},t=()=>{const n=B.map(o=>({Date:o.date,Crop:c?.find(j=>j.id===o.cropId)?.name||o.cropId,Quantity:o.quantity,"Price/Unit":`KES ${o.pricePerUnit}`,Total:`KES ${o.totalPrice}`,Sold:o.sold?"Yes":"No"}));V(n,"crop_yield","Crop Yield Records")};return e.jsxs("section",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h3",{children:y?"Edit Crop Yield":"Crop yield"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{onClick:R,title:"Export to CSV",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“Š CSV"}),e.jsx("button",{onClick:()=>_(B,"crop_yield.csv"),title:"Export to Excel",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“ˆ Excel"}),e.jsx("button",{onClick:t,title:"Export to PDF",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“• PDF"}),e.jsx("button",{onClick:()=>Q(B,"crop_yield.json"),title:"Export to JSON",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“„ JSON"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(150px,1fr))",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{padding:12,background:"#f0f9ff",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666"},children:"Total Harvest"}),e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#0369a1"},children:D})]}),e.jsxs("div",{style:{padding:12,background:"#f0fdf4",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666"},children:"Sold Quantity"}),e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#15803d"},children:I})]}),e.jsxs("div",{style:{padding:12,background:"#fefce8",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666"},children:"Total Revenue"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#ca8a04"},children:["KES ",A.toFixed(2)]})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[!a&&e.jsxs("select",{value:v,onChange:n=>T(n.target.value),children:[e.jsx("option",{value:"",children:"-- select crop --"}),(c||[]).map(n=>e.jsxs("option",{value:n.id,children:[n.name," (",n.id,")"]},n.id))]}),e.jsx("input",{placeholder:"Quantity",value:h,onChange:n=>S(n.target.value),style:{width:100}}),e.jsx("input",{placeholder:"Price/Unit",value:g,onChange:n=>E(n.target.value),style:{width:100}}),e.jsx("input",{placeholder:"Buyer (optional)",value:C,onChange:n=>d(n.target.value),style:{width:150}}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("input",{type:"checkbox",checked:p,onChange:n=>k(n.target.checked)}),"Mark as Sold ",p&&g&&h?`(KES ${(parseFloat(g)*parseFloat(h)).toFixed(2)})`:""]}),e.jsx("button",{onClick:W,children:y?"Save Changes":"Add"}),y&&e.jsx("button",{onClick:N,children:"Cancel Edit"})]}),e.jsx("ul",{style:{listStyle:"none",padding:0},children:B.map(n=>e.jsxs("li",{style:{padding:8,borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:[n.quantity," units",n.sold&&e.jsx("span",{style:{marginLeft:8,padding:"2px 6px",background:"#dcfce7",color:"#15803d",fontSize:11,borderRadius:4,fontWeight:600},children:"âœ“ Sold"}),n.sold&&n.totalPrice>0&&e.jsxs("span",{style:{marginLeft:8,color:"#ca8a04",fontWeight:600},children:["KES ",n.totalPrice.toFixed(2)]}),e.jsxs("small",{style:{color:"#666",marginLeft:8},children:["(",n.id,")"]})]}),e.jsxs("div",{style:{fontSize:13,color:"#666"},children:[n.date," ",a?"":`â€¢ ${n.cropId}`,n.buyer&&e.jsxs("span",{children:[" â€¢ Buyer: ",n.buyer]}),n.pricePerUnit>0&&e.jsxs("span",{children:[" â€¢ @ ",n.pricePerUnit,"/unit"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{onClick:()=>x(n),children:"âœï¸"}),e.jsx("button",{onClick:()=>l(n.id),children:"ðŸ—‘ï¸"})]})]},n.id))})]})}const le=[{id:"CS-001",cropId:"C-001",date:"2025-06-20",quantity:2500,unit:"lbs",pricePerUnit:.35,totalPrice:875,buyer:"Local Dairy Farms",buyerContact:"+254 712 345 678",paymentMethod:"Bank Transfer",paymentStatus:"Paid",deliveryDate:"2025-06-20",deliveryMethod:"Pickup",qualityGrade:"Premium",moisture:12.5,notes:"Premium quality alfalfa, first cutting"}],se=["Cash","M-Pesa","Bank Transfer","Check","Credit"],de=["Pending","Paid","Partial","Overdue","Cancelled"],oe=["Pickup","Delivery","Will-Call","Shipping"],ce=["Premium","Grade A","Grade B","Standard","Below Standard"];function pe({crops:c,cropId:a}){const m="cattalytics:crop:sales",[s,u]=r.useState([]),[v,T]=r.useState(!1),[h,S]=r.useState(a||(c&&c[0]?c[0].id:"")),[g,E]=r.useState(""),[C,d]=r.useState("lbs"),[p,k]=r.useState("0.35"),[y,P]=r.useState(""),[W,l]=r.useState(""),[x,N]=r.useState("Bank Transfer"),[B,A]=r.useState("Paid"),[I,D]=r.useState(new Date().toISOString().slice(0,10)),[R,t]=r.useState("Pickup"),[n,o]=r.useState("Premium"),[j,M]=r.useState(""),[L,O]=r.useState("");r.useEffect(()=>{const i=localStorage.getItem(m);u(i?JSON.parse(i):le)},[]),r.useEffect(()=>localStorage.setItem(m,JSON.stringify(s)),[s]);function F(){if(!h||!g||!p||!y.trim()){alert("Please fill in all required fields: Crop, Quantity, Price, and Buyer");return}const i="CS-"+Math.floor(1e3+Math.random()*9e3),b=Number(g),f=parseFloat(p),w=b*f,q=c?.find(ne=>ne.id===h)?.name||h,Y={id:i,cropId:h,date:new Date().toISOString().slice(0,10),quantity:b,unit:C,pricePerUnit:f,totalPrice:w,buyer:y.trim(),buyerContact:W.trim(),paymentMethod:x,paymentStatus:B,deliveryDate:I,deliveryMethod:R,qualityGrade:n,moisture:parseFloat(j)||0,notes:L.trim(),timestamp:new Date().toISOString()};(B==="Paid"||B==="Partial")&&$({amount:w,category:"Crop Sales",subcategory:n,description:`${q}: ${b} ${C} @ ${f}/${C} to ${y}`,vendor:y,source:"Crop Sales",linkedId:i,date:Y.date}),u([...s,Y]),E(""),k("0.35"),P(""),l(""),D(new Date().toISOString().slice(0,10)),M(""),O(""),T(!1)}function X(i){confirm("Delete sale record "+i+"?")&&u(s.filter(b=>b.id!==i))}function Z(i,b){const f=s.find(w=>w.id===i);if(f){if(f.paymentStatus!=="Paid"){const w=c?.find(q=>q.id===f.cropId)?.name||f.cropId;$({amount:f.totalPrice,category:"Crop Sales",subcategory:f.qualityGrade,description:`${w}: ${f.quantity} ${f.unit} @ ${f.pricePerUnit}/${f.unit} to ${f.buyer}`,vendor:f.buyer,source:"Crop Sales",linkedId:i,date:f.date})}u(s.map(w=>w.id===i?{...w,paymentStatus:b}:w))}}const z=a?s.filter(i=>i.cropId===a):s,H=z.reduce((i,b)=>i+(b.totalPrice||0),0),ee=z.filter(i=>i.paymentStatus==="Paid").reduce((i,b)=>i+(b.totalPrice||0),0),te=z.filter(i=>i.paymentStatus==="Pending"||i.paymentStatus==="Partial").reduce((i,b)=>i+(b.totalPrice||0),0),U=z.reduce((i,b)=>i+(b.quantity||0),0),ie=U>0?H/U:0;return e.jsxs("section",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h3",{children:"Crop Sales & Revenue"}),e.jsx("button",{onClick:()=>T(!v),style:{background:"var(--green)",color:"#fff",padding:"8px 16px",borderRadius:"6px",border:"none"},children:v?"Cancel":"Record New Sale"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:12,marginBottom:20},children:[e.jsxs("div",{style:{padding:16,background:"#f0fdf4",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:4},children:"Total Revenue"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#15803d"},children:["KES ",H.toFixed(2)]})]}),e.jsxs("div",{style:{padding:16,background:"#ecfdf5",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:4},children:"Paid Amount"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#059669"},children:["KES ",ee.toFixed(2)]})]}),e.jsxs("div",{style:{padding:16,background:"#fef3c7",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:4},children:"Pending Payment"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#d97706"},children:["KES ",te.toFixed(2)]})]}),e.jsxs("div",{style:{padding:16,background:"#eff6ff",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:4},children:"Total Sold"}),e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#2563eb"},children:U.toFixed(0)})]}),e.jsxs("div",{style:{padding:16,background:"#faf5ff",borderRadius:8},children:[e.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:4},children:"Avg Price/Unit"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#7c3aed"},children:["KES ",ie.toFixed(2)]})]})]}),v&&e.jsxs("div",{className:"card",style:{marginBottom:20,padding:20},children:[e.jsx("h4",{style:{marginTop:0},children:"Record New Sale"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[!a&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Crop *"}),e.jsxs("select",{value:h,onChange:i=>S(i.target.value),children:[e.jsx("option",{value:"",children:"-- select crop --"}),(c||[]).map(i=>e.jsxs("option",{value:i.id,children:[i.name," (",i.id,")"]},i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Quantity *"}),e.jsx("input",{type:"number",step:"0.1",placeholder:"0.0",value:g,onChange:i=>E(i.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Unit"}),e.jsxs("select",{value:C,onChange:i=>d(i.target.value),children:[e.jsx("option",{value:"lbs",children:"Pounds (lbs)"}),e.jsx("option",{value:"kg",children:"Kilograms (kg)"}),e.jsx("option",{value:"tons",children:"Tons"}),e.jsx("option",{value:"bushels",children:"Bushels"}),e.jsx("option",{value:"bales",children:"Bales"}),e.jsx("option",{value:"bags",children:"Bags"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Price per Unit *"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:p,onChange:i=>k(i.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Total Price"}),e.jsx("input",{type:"text",readOnly:!0,value:g&&p?`KES ${(parseFloat(g)*parseFloat(p)).toFixed(2)}`:"KES 0.00",style:{background:"#f9fafb",fontWeight:600}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Buyer Name *"}),e.jsx("input",{placeholder:"e.g., ABC Dairy Farm",value:y,onChange:i=>P(i.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Buyer Contact"}),e.jsx("input",{placeholder:"+254 712 345 678",value:W,onChange:i=>l(i.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Payment Method"}),e.jsx("select",{value:x,onChange:i=>N(i.target.value),children:se.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Payment Status"}),e.jsx("select",{value:B,onChange:i=>A(i.target.value),children:de.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Delivery Date"}),e.jsx("input",{type:"date",value:I,onChange:i=>D(i.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Delivery Method"}),e.jsx("select",{value:R,onChange:i=>t(i.target.value),children:oe.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Quality Grade"}),e.jsx("select",{value:n,onChange:i=>o(i.target.value),children:ce.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Moisture %"}),e.jsx("input",{type:"number",step:"0.1",placeholder:"0.0",value:j,onChange:i=>M(i.target.value)})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500},children:"Notes"}),e.jsx("textarea",{placeholder:"Additional sale details...",value:L,onChange:i=>O(i.target.value),rows:2,style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #d1d5db"}})]})]}),e.jsxs("div",{style:{marginTop:16,display:"flex",gap:8},children:[e.jsx("button",{onClick:F,style:{background:"var(--green)",color:"#fff",padding:"10px 20px",border:"none",borderRadius:6},children:"Record Sale"}),e.jsx("button",{onClick:()=>T(!1),style:{background:"#6b7280",color:"#fff",padding:"10px 20px",border:"none",borderRadius:6},children:"Cancel"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"Sales History"}),e.jsxs("ul",{style:{listStyle:"none",padding:0},children:[z.length===0&&e.jsx("li",{style:{padding:20,textAlign:"center",color:"#666",fontStyle:"italic"},children:'No sales recorded yet. Click "Record New Sale" to add your first sale.'}),z.map(i=>{const b=c?.find(f=>f.id===i.cropId)?.name||i.cropId;return e.jsxs("li",{style:{padding:16,borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:600,fontSize:16,marginBottom:4},children:[b," - ",i.quantity," ",i.unit,e.jsx("span",{style:{marginLeft:8,padding:"2px 8px",background:i.paymentStatus==="Paid"?"#dcfce7":i.paymentStatus==="Pending"?"#fef3c7":"#fee2e2",color:i.paymentStatus==="Paid"?"#15803d":i.paymentStatus==="Pending"?"#92400e":"#dc2626",fontSize:12,borderRadius:4,fontWeight:600},children:i.paymentStatus}),e.jsxs("span",{style:{marginLeft:12,color:"#059669",fontWeight:700,fontSize:18},children:["KES ",i.totalPrice.toFixed(2)]})]}),e.jsxs("div",{style:{fontSize:14,color:"#666",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:8},children:[e.jsxs("div",{children:["ðŸ“… ",i.date," â€¢ ðŸšš ",i.deliveryMethod]}),e.jsxs("div",{children:["ðŸ‘¤ ",i.buyer," ",i.buyerContact&&`â€¢ ${i.buyerContact}`]}),e.jsxs("div",{children:["ðŸ’³ ",i.paymentMethod," â€¢ â­ ",i.qualityGrade]}),e.jsxs("div",{children:["@ KES ",i.pricePerUnit,"/",i.unit," ",i.moisture>0&&`â€¢ ðŸ’§ ${i.moisture}%`]})]}),i.notes&&e.jsxs("div",{style:{fontSize:13,color:"#666",fontStyle:"italic",marginTop:4},children:["ðŸ“ ",i.notes]})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexDirection:"column"},children:[i.paymentStatus!=="Paid"&&e.jsx("button",{onClick:()=>Z(i.id,"Paid"),style:{padding:"6px 12px",background:"#059669",color:"#fff",border:"none",borderRadius:4,fontSize:12},children:"Mark Paid"}),e.jsx("button",{onClick:()=>X(i.id),style:{padding:"6px 12px",background:"#dc2626",color:"#fff",border:"none",borderRadius:4,fontSize:12},children:"Delete"})]})]},i.id)})]})]})]})}const xe=[{id:"CT-001",cropId:"C-001",date:"2025-05-01",treatment:"Fungicide"}];function ue({crops:c,cropId:a}){const m="cattalytics:crop:treatment",[s,u]=r.useState([]),[v,T]=r.useState(a||(c&&c[0]?c[0].id:"")),[h,S]=r.useState(""),[g,E]=r.useState(null);r.useEffect(()=>{const l=localStorage.getItem(m);u(l?JSON.parse(l):xe)},[]),r.useEffect(()=>localStorage.setItem(m,JSON.stringify(s)),[s]);function C(){if(!v||!h.trim())return;if(g){u(s.map(x=>x.id===g?{...x,cropId:v,treatment:h.trim()}:x)),E(null),S("");return}const l="CT-"+Math.floor(1e3+Math.random()*9e3);u([...s,{id:l,cropId:v,date:new Date().toISOString().slice(0,10),treatment:h.trim()}]),S("")}function d(l){confirm("Delete record "+l+"?")&&u(s.filter(x=>x.id!==l))}function p(l){E(l.id),T(l.cropId),S(l.treatment)}function k(){E(null),S(""),!a&&c&&c[0]&&T(c[0].id)}const y=a?s.filter(l=>l.cropId===a):s,P=()=>{const l=y.map(x=>({ID:x.id,Date:x.date,Crop:c?.find(N=>N.id===x.cropId)?.name||x.cropId,Treatment:x.treatment}));J(l,"crop_treatments.csv")},W=()=>{const l=y.map(x=>({Date:x.date,Crop:c?.find(N=>N.id===x.cropId)?.name||x.cropId,Treatment:x.treatment}));V(l,"crop_treatments","Crop Treatment Records")};return e.jsxs("section",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h3",{children:g?"Edit Crop Treatment":"Crop treatments"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{onClick:P,title:"Export to CSV",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“Š CSV"}),e.jsx("button",{onClick:()=>_(y,"crop_treatments.csv"),title:"Export to Excel",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“ˆ Excel"}),e.jsx("button",{onClick:W,title:"Export to PDF",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“• PDF"}),e.jsx("button",{onClick:()=>Q(y,"crop_treatments.json"),title:"Export to JSON",style:{fontSize:11,padding:"4px 8px"},children:"ðŸ“„ JSON"})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[!a&&e.jsxs("select",{value:v,onChange:l=>T(l.target.value),children:[e.jsx("option",{value:"",children:"-- select crop --"}),(c||[]).map(l=>e.jsxs("option",{value:l.id,children:[l.name," (",l.id,")"]},l.id))]}),e.jsx("input",{placeholder:"Treatment",value:h,onChange:l=>S(l.target.value)}),e.jsx("button",{onClick:C,children:g?"Save Changes":"Add"}),g&&e.jsx("button",{onClick:k,children:"Cancel Edit"})]}),e.jsx("ul",{style:{listStyle:"none",padding:0},children:y.map(l=>e.jsxs("li",{style:{padding:8,borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:[l.treatment," ",e.jsxs("small",{style:{color:"#666"},children:["(",l.id,")"]})]}),e.jsxs("div",{style:{fontSize:13,color:"#666"},children:[l.date," ",a?"":`â€¢ ${l.cropId}`]})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{onClick:()=>p(l),children:"âœï¸"}),e.jsx("button",{onClick:()=>d(l.id),children:"ðŸ—‘ï¸"})]})]},l.id))})]})}const G=[{id:"C-001",name:"Premium Alfalfa",variety:"Vernal",planted:"2025-03-15",expectedHarvest:"2025-07-15",actualHarvest:"",area:5.2,field:"North Field A",status:"Growing",soilType:"Clay Loam",irrigationType:"Sprinkler",seedCost:450,notes:"Premium alfalfa field with excellent soil conditions",cropType:"Forage",certificationLevel:"Certified Organic",marketDestination:"Local Dairy Farms"},{id:"C-002",name:"Field Corn",variety:"Pioneer 1234",planted:"2025-04-20",expectedHarvest:"2025-09-15",actualHarvest:"",area:12.8,field:"South Field B",status:"Planted",soilType:"Sandy Loam",irrigationType:"Center Pivot",seedCost:2800,notes:"",cropType:"Grain",certificationLevel:"Conventional",marketDestination:"Grain Elevator"}],ge=["Grain","Forage","Vegetable","Fruit","Cover Crop","Other"],he=["Clay","Clay Loam","Loam","Sandy Loam","Sand","Silt","Silt Loam"],ye=["Dryland","Sprinkler","Drip","Center Pivot","Flood","Furrow"],K=["Planned","Planted","Germinating","Growing","Flowering","Mature","Harvested","Failed"],fe=["Conventional","Certified Organic","Transitional Organic","Non-GMO"];function be(){const c="cattalytics:crops",[a,m]=r.useState("list"),[s,u]=r.useState([]),[v,T]=r.useState(""),[h,S]=r.useState("all"),[g,E]=r.useState("planted"),C={name:"",variety:"",field:"",area:"",planted:"",expectedHarvest:"",actualHarvest:"",soilType:"Loam",irrigationType:"Sprinkler",status:"Planned",cropType:"Grain",certificationLevel:"Conventional",marketDestination:"",seedCost:"",notes:""},[d,p]=r.useState(C),[k,y]=r.useState(null),[P,W]=r.useState({});r.useEffect(()=>{const t=localStorage.getItem(c);if(t)try{u(JSON.parse(t))}catch{console.log("Loading sample data"),u(G)}else u(G)},[]),r.useEffect(()=>{s.length>0&&localStorage.setItem(c,JSON.stringify(s))},[s]);function l(t){const n={};if((!t.name||!t.name.trim())&&(n.name="Crop name is required"),(!t.area||Number(t.area)<=0)&&(n.area="Area must be greater than 0"),t.planted){const o=Date.parse(t.planted);Number.isNaN(o)&&(n.planted="Invalid planting date")}return n}function x(){p(C),y(null),W({})}function N(t){t&&t.preventDefault();const n={...d},o=l(n);if(W(o),!Object.keys(o).length){if(k)u(s.map(j=>j.id===k?{...j,...n}:j));else{const j="C-"+Math.floor(1e3+Math.random()*9e3);u([...s,{...n,id:j}])}x(),m("list")}}function B(t){p(t),y(t.id),m("addCrop")}function A(t){window.confirm("Delete crop "+t+"?")&&u(s.filter(n=>n.id!==t))}const I=v.trim().toLowerCase(),D=s.filter(t=>!(I&&!((t.name||"").toLowerCase().includes(I)||(t.variety||"").toLowerCase().includes(I)||(t.field||"").toLowerCase().includes(I)||(t.id||"").toLowerCase().includes(I))||h!=="all"&&t.status!==h)).sort((t,n)=>g==="name"?(t.name||"").localeCompare(n.name||""):g==="area"?(n.area||0)-(t.area||0):g==="planted"?new Date(n.planted||"1900-01-01")-new Date(t.planted||"1900-01-01"):0),R={total:s.length,totalArea:s.reduce((t,n)=>t+(Number(n.area)||0),0),active:s.filter(t=>!["Harvested","Failed"].includes(t.status)).length,harvested:s.filter(t=>t.status==="Harvested").length};return e.jsxs("section",{children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h2",{style:{margin:0},children:"Crop Management"}),a==="list"&&e.jsx("button",{onClick:()=>m("addCrop"),style:{background:"var(--green)",color:"#fff",padding:"10px 16px",borderRadius:"8px",border:"none",cursor:"pointer"},children:"Add New Crop"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[e.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--green)"},children:R.total}),e.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Total Crops"})]}),e.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#f59e0b"},children:R.totalArea.toFixed(1)}),e.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Total Acres"})]}),e.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:R.active}),e.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Active Crops"})]}),e.jsxs("div",{className:"card",style:{padding:"16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#6b7280"},children:R.harvested}),e.jsx("div",{style:{fontSize:"14px",color:"var(--muted)"},children:"Harvested"})]})]}),e.jsx("div",{style:{borderBottom:"2px solid #e5e7eb",marginBottom:"20px"},children:e.jsxs("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[e.jsx("button",{onClick:()=>m("list"),style:{padding:"12px 20px",border:"none",borderBottom:a==="list"?"3px solid var(--green)":"3px solid transparent",background:a==="list"?"#f0fdf4":"transparent",color:a==="list"?"var(--green)":"#6b7280",fontWeight:a==="list"?"600":"400",cursor:"pointer"},children:"ðŸ“‹ Crop List"}),e.jsx("button",{onClick:()=>m("yields"),style:{padding:"12px 20px",border:"none",borderBottom:a==="yields"?"3px solid var(--green)":"3px solid transparent",background:a==="yields"?"#f0fdf4":"transparent",color:a==="yields"?"var(--green)":"#6b7280",fontWeight:a==="yields"?"600":"400",cursor:"pointer"},children:"ðŸŒ¾ Yields & Harvest"}),e.jsx("button",{onClick:()=>m("sales"),style:{padding:"12px 20px",border:"none",borderBottom:a==="sales"?"3px solid var(--green)":"3px solid transparent",background:a==="sales"?"#f0fdf4":"transparent",color:a==="sales"?"var(--green)":"#6b7280",fontWeight:a==="sales"?"600":"400",cursor:"pointer"},children:"ðŸ’° Sales & Revenue"}),e.jsx("button",{onClick:()=>m("treatments"),style:{padding:"12px 20px",border:"none",borderBottom:a==="treatments"?"3px solid var(--green)":"3px solid transparent",background:a==="treatments"?"#f0fdf4":"transparent",color:a==="treatments"?"var(--green)":"#6b7280",fontWeight:a==="treatments"?"600":"400",cursor:"pointer"},children:"ðŸ§ª Treatments & Inputs"})]})})]}),a==="list"&&e.jsxs("div",{children:[e.jsx("div",{className:"card",style:{marginBottom:"20px",padding:"16px"},children:e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("input",{type:"text",placeholder:"ðŸ” Search crops...",value:v,onChange:t=>T(t.target.value),style:{flex:"1 1 200px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db"}}),e.jsxs("select",{value:h,onChange:t=>S(t.target.value),style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db"},children:[e.jsx("option",{value:"all",children:"All Status"}),K.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:g,onChange:t=>E(t.target.value),style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db"},children:[e.jsx("option",{value:"planted",children:"Sort by Planted Date"}),e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"area",children:"Sort by Area"})]})]})}),e.jsxs("div",{style:{display:"grid",gap:"12px"},children:[D.length===0&&e.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No crops found. Add your first crop to get started!"}),D.map(t=>e.jsx("div",{className:"card",style:{padding:"20px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[e.jsx("h3",{style:{margin:0},children:t.name}),e.jsx("span",{className:"badge",style:{background:t.status==="Harvested"?"#dcfce7":t.status==="Failed"?"#fee2e2":"#dbeafe",color:t.status==="Harvested"?"#15803d":t.status==="Failed"?"#dc2626":"#1e40af",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600"},children:t.status}),e.jsx("span",{className:"badge",style:{background:"#f3f4f6",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:t.irrigationType})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Variety"}),e.jsx("div",{style:{fontWeight:"500"},children:t.variety||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Field"}),e.jsx("div",{style:{fontWeight:"500"},children:t.field||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Area"}),e.jsxs("div",{style:{fontWeight:"500"},children:[t.area," acres"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Soil Type"}),e.jsx("div",{style:{fontWeight:"500"},children:t.soilType})]})]}),e.jsxs("div",{style:{display:"flex",gap:"20px",fontSize:"14px",color:"#666"},children:[e.jsxs("span",{children:["ðŸ“… Planted: ",t.planted||"Not set"]}),e.jsxs("span",{children:["ðŸŒ¾ Expected: ",t.expectedHarvest||"Not set"]}),t.actualHarvest&&e.jsxs("span",{children:["âœ… Harvested: ",t.actualHarvest]})]})]}),e.jsxs("div",{className:"controls",style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>B(t),children:"Edit"}),e.jsx("button",{onClick:()=>A(t.id),children:"Delete"})]})]})},t.id))]})]}),a==="addCrop"&&e.jsxs("div",{className:"card",style:{padding:"24px",maxWidth:"900px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{children:k?"Edit Crop":"Add New Crop"}),e.jsx("button",{onClick:()=>{x(),m("list")},style:{background:"#6b7280",color:"#fff",padding:"8px 16px",borderRadius:"6px",border:"none"},children:"Cancel"})]}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Crop Name *"}),e.jsx("input",{type:"text",placeholder:"e.g., Premium Alfalfa",value:d.name,onChange:t=>p({...d,name:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:P.name?"2px solid #dc2626":"1px solid #d1d5db"}}),P.name&&e.jsx("div",{style:{color:"#dc2626",fontSize:"12px",marginTop:"4px"},children:P.name})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Variety/Cultivar"}),e.jsx("input",{type:"text",placeholder:"e.g., Pioneer 1234",value:d.variety,onChange:t=>p({...d,variety:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Field Location"}),e.jsx("input",{type:"text",placeholder:"e.g., North Field A",value:d.field,onChange:t=>p({...d,field:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Area (acres) *"}),e.jsx("input",{type:"number",step:"0.1",placeholder:"0.0",value:d.area,onChange:t=>p({...d,area:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:P.area?"2px solid #dc2626":"1px solid #d1d5db"}}),P.area&&e.jsx("div",{style:{color:"#dc2626",fontSize:"12px",marginTop:"4px"},children:P.area})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Crop Type"}),e.jsx("select",{value:d.cropType,onChange:t=>p({...d,cropType:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:ge.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Status"}),e.jsx("select",{value:d.status,onChange:t=>p({...d,status:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:K.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Planting Date"}),e.jsx("input",{type:"date",value:d.planted,onChange:t=>p({...d,planted:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Expected Harvest"}),e.jsx("input",{type:"date",value:d.expectedHarvest,onChange:t=>p({...d,expectedHarvest:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Soil Type"}),e.jsx("select",{value:d.soilType,onChange:t=>p({...d,soilType:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:he.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Irrigation Type"}),e.jsx("select",{value:d.irrigationType,onChange:t=>p({...d,irrigationType:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:ye.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Certification Level"}),e.jsx("select",{value:d.certificationLevel,onChange:t=>p({...d,certificationLevel:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"},children:fe.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Seed Cost (KES)"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:d.seedCost,onChange:t=>p({...d,seedCost:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Market Destination"}),e.jsx("input",{type:"text",placeholder:"e.g., Local Dairy Farms, Grain Elevator",value:d.marketDestination,onChange:t=>p({...d,marketDestination:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",fontWeight:"500"},children:"Notes"}),e.jsx("textarea",{placeholder:"Additional crop details...",value:d.notes,onChange:t=>p({...d,notes:t.target.value}),rows:3,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}})]})]}),e.jsxs("div",{style:{marginTop:"20px",display:"flex",gap:"12px"},children:[e.jsx("button",{type:"submit",style:{background:"var(--green)",color:"#fff",padding:"12px 24px",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600"},children:k?"Update Crop":"Add Crop"}),e.jsx("button",{type:"button",onClick:()=>{x(),m("list")},style:{background:"#6b7280",color:"#fff",padding:"12px 24px",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Cancel"})]})]})]}),a==="yields"&&e.jsx("div",{children:e.jsx(ae,{crops:s})}),a==="sales"&&e.jsx("div",{children:e.jsx(pe,{crops:s})}),a==="treatments"&&e.jsx("div",{children:e.jsx(ue,{crops:s})})]})}export{be as default};
