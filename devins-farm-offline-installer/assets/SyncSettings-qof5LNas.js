import{r as t,j as e}from"./index-CeDgDi5r.js";import{c as d,d as I,e as _,f as P,i as R,h as L,p as K,j as Q}from"./lib-integration-BX7JWOcy.js";import{f as V,h as X,u as Z,j as $}from"./vendor-firebase-DPzZ0AXH.js";import"./vendor-react-CqO7gtIP.js";import"./lib-core-XQuPJE47.js";import"./lib-export-Dp5-osfT.js";import"./lib-notifications-DRlqN2Ug.js";function g(){return I()&&d!==null}async function ee(l,a){if(!g())return{success:!1,error:"Firebase not configured"};try{const i=(await V(d,l,a)).user,r={userId:i.uid,username:i.email.split("@")[0],name:i.displayName||i.email,role:"MANAGER",email:i.email,loginTime:new Date().toISOString(),lastActivity:new Date().toISOString(),firebaseUser:!0};return localStorage.setItem("devinsfarm:auth",JSON.stringify(r)),{success:!0,user:r}}catch(n){return console.error("Firebase login error:",n),{success:!1,error:n.message}}}async function se(l,a,n){if(!g())return{success:!1,error:"Firebase not configured"};try{const r=(await X(d,l,a)).user;n&&await Z(r,{displayName:n});const o={userId:r.uid,username:l.split("@")[0],name:n||l,role:"MANAGER",email:r.email,loginTime:new Date().toISOString(),lastActivity:new Date().toISOString(),firebaseUser:!0};return localStorage.setItem("devinsfarm:auth",JSON.stringify(o)),{success:!0,user:o}}catch(i){return console.error("Firebase registration error:",i),{success:!1,error:i.message}}}async function re(){if(!g())return{success:!1,error:"Firebase not configured"};try{return await $(d),localStorage.removeItem("devinsfarm:auth"),{success:!0}}catch(l){return console.error("Firebase logout error:",l),{success:!1,error:l.message}}}function b(){return g()?d.currentUser:null}function de(){const[l,a]=t.useState(!1),[n,i]=t.useState(!1),[r,o]=t.useState("offline"),[x,u]=t.useState(null),[B,h]=t.useState(!1),[N,f]=t.useState(!1),[m,z]=t.useState(""),[j,O]=t.useState(""),[S,v]=t.useState(""),[w,W]=t.useState(""),[C,D]=t.useState(""),[F,U]=t.useState(""),[E,k]=t.useState(""),[y,A]=t.useState(!1),[p,T]=t.useState(!1);t.useEffect(()=>{a(I()),i(_()),o(P()),u(b());const s=setInterval(()=>{o(P())},2e3);return()=>clearInterval(s)},[]);async function G(s){s.preventDefault(),v("");const c=await ee(m,j);c.success?(u(b()),h(!1),R(),alert("âœ… Logged in successfully! You can now enable sync.")):v(c.error)}async function q(s){s.preventDefault(),k("");const c=await se(C,F,w);c.success?(u(b()),f(!1),R(),alert("âœ… Account created successfully! You can now enable sync.")):k(c.error)}async function Y(){(await re()).success&&(u(null),i(!1),L(!1),alert("âœ… Logged out successfully"))}function H(){const s=!n;L(s),i(s),alert(s?"âœ… Sync enabled! Your data will now sync across devices automatically.":"âš ï¸ Sync disabled. Your data will only be stored locally.")}async function M(){if(!confirm("Push all local data to Firebase? This will overwrite cloud data."))return;A(!0);const s=await K();A(!1),alert(s?"âœ… All data pushed to Firebase successfully!":"âŒ Error pushing data. Check console for details.")}async function J(){if(!confirm("Pull all data from Firebase? This will overwrite local data and reload the page."))return;T(!0),await Q()||(T(!1),alert("âŒ Error pulling data. Check console for details."))}return l?e.jsxs("section",{children:[e.jsx("h2",{children:"ðŸ”„ Cloud Sync Settings"}),e.jsx("div",{style:{background:"#d1fae5",border:"1px solid #10b981",padding:15,borderRadius:8,marginTop:20},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{fontSize:24},children:"âœ…"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Firebase Configured"}),e.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Cloud sync is available"})]})]})}),e.jsxs("div",{style:{marginTop:30},children:[e.jsx("h3",{children:"ðŸ” Authentication"}),x?e.jsxs("div",{children:[e.jsxs("div",{style:{padding:15,background:"#f9fafb",borderRadius:8,border:"1px solid #e5e7eb",marginBottom:15},children:[e.jsx("strong",{children:"Logged in as:"})," ",x.email,e.jsx("button",{onClick:Y,style:{marginLeft:15,fontSize:12,padding:"4px 12px"},children:"Logout"})]}),e.jsx("div",{style:{marginTop:20},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n,onChange:H,style:{width:20,height:20}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Enable Auto-Sync"}),e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Automatically sync data across all your devices in real-time"})]})]})}),e.jsxs("div",{style:{marginTop:20},children:[e.jsx("strong",{children:"Sync Status:"})," ",e.jsxs("span",{style:{padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:600,background:r==="synced"?"#d1fae5":r==="syncing"?"#fed7aa":r==="error"?"#fee2e2":"#e5e7eb",color:r==="synced"?"#065f46":r==="syncing"?"#92400e":r==="error"?"#991b1b":"#374151"},children:[r==="synced"&&"âœ… Synced",r==="syncing"&&"ðŸ”„ Syncing...",r==="error"&&"âŒ Error",r==="offline"&&"â¸ï¸ Offline"]})]}),e.jsxs("div",{style:{marginTop:30},children:[e.jsx("h3",{children:"Manual Sync"}),e.jsx("p",{style:{fontSize:14,color:"#6b7280"},children:"Use these if you need to manually sync data between devices"}),e.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[e.jsx("button",{onClick:M,disabled:y||!n,style:{opacity:!n||y?.5:1},children:y?"â³ Pushing...":"â¬†ï¸ Push All to Cloud"}),e.jsx("button",{onClick:J,disabled:p||!n,style:{opacity:!n||p?.5:1},children:p?"â³ Pulling...":"â¬‡ï¸ Pull All from Cloud"})]}),e.jsxs("p",{style:{fontSize:12,color:"#6b7280",marginTop:10},children:[e.jsx("strong",{children:"Note:"})," Push overwrites cloud data. Pull overwrites local data and reloads the app."]})]})]}):e.jsxs("div",{children:[e.jsx("p",{children:"You must be logged in to enable sync."}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("button",{onClick:()=>h(!0),children:"Login"}),e.jsx("button",{onClick:()=>f(!0),children:"Create Account"})]}),B&&e.jsxs("div",{style:{marginTop:20,padding:20,background:"#f9fafb",borderRadius:8,border:"1px solid #e5e7eb"},children:[e.jsx("h4",{style:{marginTop:0},children:"Login"}),e.jsxs("form",{onSubmit:G,children:[e.jsxs("div",{style:{marginBottom:15},children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:m,onChange:s=>z(s.target.value),required:!0,style:{display:"block",width:"100%",marginTop:5}})]}),e.jsxs("div",{style:{marginBottom:15},children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",value:j,onChange:s=>O(s.target.value),required:!0,style:{display:"block",width:"100%",marginTop:5}})]}),S&&e.jsx("div",{style:{color:"#dc2626",marginBottom:15,fontSize:14},children:S}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("button",{type:"submit",children:"Login"}),e.jsx("button",{type:"button",onClick:()=>h(!1),children:"Cancel"})]})]})]}),N&&e.jsxs("div",{style:{marginTop:20,padding:20,background:"#f9fafb",borderRadius:8,border:"1px solid #e5e7eb"},children:[e.jsx("h4",{style:{marginTop:0},children:"Create Account"}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{style:{marginBottom:15},children:[e.jsx("label",{children:"Full Name"}),e.jsx("input",{type:"text",value:w,onChange:s=>W(s.target.value),required:!0,style:{display:"block",width:"100%",marginTop:5}})]}),e.jsxs("div",{style:{marginBottom:15},children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:C,onChange:s=>D(s.target.value),required:!0,style:{display:"block",width:"100%",marginTop:5}})]}),e.jsxs("div",{style:{marginBottom:15},children:[e.jsx("label",{children:"Password (min 6 characters)"}),e.jsx("input",{type:"password",value:F,onChange:s=>U(s.target.value),required:!0,minLength:6,style:{display:"block",width:"100%",marginTop:5}})]}),E&&e.jsx("div",{style:{color:"#dc2626",marginBottom:15,fontSize:14},children:E}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("button",{type:"submit",children:"Create Account"}),e.jsx("button",{type:"button",onClick:()=>f(!1),children:"Cancel"})]})]})]})]})]}),e.jsxs("div",{style:{marginTop:40,padding:20,background:"#eff6ff",borderRadius:8,border:"1px solid #3b82f6"},children:[e.jsx("h3",{style:{marginTop:0},children:"â„¹ï¸ How Sync Works"}),e.jsxs("ul",{style:{lineHeight:1.8,marginBottom:0},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Real-time:"})," Changes sync instantly across all logged-in devices"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Offline-first:"})," Works offline, syncs when back online"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Secure:"})," Data encrypted and only accessible to you"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Free:"})," 1GB storage on Firebase free tier (enough for years of farm data)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Private:"})," No one else can access your data"]})]})]})]}):e.jsxs("section",{children:[e.jsx("h2",{children:"ðŸ”„ Cloud Sync Settings"}),e.jsxs("div",{style:{background:"#fef3c7",border:"1px solid #f59e0b",padding:20,borderRadius:8,marginTop:20},children:[e.jsx("h3",{style:{marginTop:0},children:"âš ï¸ Firebase Not Configured"}),e.jsx("p",{children:"To enable cloud sync, you need to configure Firebase:"}),e.jsxs("ol",{style:{lineHeight:1.8},children:[e.jsxs("li",{children:["Go to ",e.jsx("a",{href:"https://console.firebase.google.com",target:"_blank",rel:"noopener",children:"Firebase Console"})]}),e.jsx("li",{children:"Create a new project (or use existing)"}),e.jsx("li",{children:"Add a Web app to your project"}),e.jsx("li",{children:"Copy the Firebase configuration"}),e.jsxs("li",{children:["Edit ",e.jsx("code",{children:"src/lib/firebase.js"})," and paste your config"]}),e.jsx("li",{children:"Enable Firestore Database in Firebase Console"}),e.jsx("li",{children:"Enable Authentication > Email/Password"}),e.jsxs("li",{children:["Rebuild your app: ",e.jsx("code",{children:"npm run build"})]})]}),e.jsxs("p",{style:{marginBottom:0},children:[e.jsx("strong",{children:"Note:"})," Firebase is free for up to 1GB storage and 10GB bandwidth per month."]})]})]})}export{de as default};
